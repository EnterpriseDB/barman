.\" Automatically generated by Pandoc 2.2.1
.\"
.TH "BARMAN\-CLOUD\-BACKUP\-DELETE" "1" "October 20, 2022" "Barman User manuals" "Version 3.2.0"
.hy
.SH NAME
.PP
barman\-cloud\-backup\-keep \- Flag backups which should be kept forever
.SH SYNOPSIS
.PP
barman\-cloud\-backup\-keep [\f[I]OPTIONS\f[]] \f[I]SOURCE_URL\f[]
\f[I]SERVER_NAME\f[] \f[I]BACKUP_ID\f[]
.SH DESCRIPTION
.PP
This script can be used to flag backups previously made with
\f[C]barman\-cloud\-backup\f[] as archival backups.
Archival backups are kept forever regardless of any retention policies
applied.
.PP
This script and Barman are administration tools for disaster recovery of
PostgreSQL servers written in Python and maintained by EnterpriseDB.
.SH POSITIONAL ARGUMENTS
.TP
.B SOURCE_URL
URL of the cloud source, such as a bucket in AWS S3.
For example: \f[C]s3://BUCKET_NAME/path/to/folder\f[] (where
\f[C]BUCKET_NAME\f[] is the bucket you have created in AWS).
.RS
.RE
.TP
.B SERVER_NAME
the name of the server as configured in Barman.
.RS
.RE
.TP
.B BACKUP_ID
a valid Backup ID for a backup in cloud storage
.RS
.RE
.SH OPTIONS
.TP
.B \-h, \[en]help
show a help message and exit
.RS
.RE
.TP
.B \-V, \[en]version
show program's version number and exit
.RS
.RE
.TP
.B \-v, \[en]verbose
increase output verbosity (e.g., \-vv is more than \-v)
.RS
.RE
.TP
.B \-q, \[en]quiet
decrease output verbosity (e.g., \-qq is less than \-q)
.RS
.RE
.TP
.B \-t, \[en]test
test connectivity to the cloud destination and exit
.RS
.RE
.TP
.B \[en]target \f[I]RECOVERY_TARGET\f[]
Specify the recovery target for the archival backup.
Possible values for \f[I]RECOVERY_TARGET\f[] are:
.RS
.IP \[bu] 2
\f[I]full\f[]: The backup can always be used to recover to the latest
point in time.
To achieve this, Barman will retain all WALs needed to ensure
consistency of the backup and all subsequent WALs.
.IP \[bu] 2
\f[I]standalone\f[]: The backup can only be used to recover the server
to its state at the time the backup was taken.
Barman will only retain the WALs needed to ensure consistency of the
backup.
.RE
.TP
.B \-s, \[en]status
Report the archival status of the backup.
This will either be the recovery target of \f[I]full\f[] or
\f[I]standalone\f[] for archival backups or \f[I]nokeep\f[] for backups
which have not been flagged as archival.
.RS
.RE
.TP
.B \-r, \[en]release
Release the keep flag from this backup.
This will remove its archival status and make it available for deletion,
either directly or by retention policy.
.RS
.RE
.TP
.B \[en]cloud\-provider {aws\-s3,azure\-blob\-storage,google\-cloud\-storage}
the cloud provider to which the backup should be uploaded
.RS
.RE
.TP
.B \-P, \[en]profile
profile name (e.g.\ INI section in AWS credentials file)
.RS
.RE
.TP
.B \[en]endpoint\-url
override the default S3 URL construction mechanism by specifying an
endpoint.
.RS
.RE
.TP
.B \[en]read\-timeout \f[I]TIMEOUT\f[]
the time in seconds until a timeout is raised when waiting to read from
a connection to AWS S3 (defaults to 60 seconds)
.RS
.RE
.TP
.B \[en]credential {azure\-cli,managed\-identity}
optionally specify the type of credential to use when authenticating
with Azure Blob Storage.
If omitted then the credential will be obtained from the environment.
If no credentials can be found in the environment then the default Azure
authentication flow will be used.
.RS
.RE
.SH REFERENCES
.PP
For Boto:
.IP \[bu] 2
https://boto3.amazonaws.com/v1/documentation/api/latest/guide/configuration.html
.PP
For AWS:
.IP \[bu] 2
https://docs.aws.amazon.com/cli/latest/userguide/cli\-chap\-getting\-set\-up.html
.IP \[bu] 2
https://docs.aws.amazon.com/cli/latest/userguide/cli\-chap\-getting\-started.html.
.PP
For Azure Blob Storage:
.IP \[bu] 2
https://docs.microsoft.com/en\-us/azure/storage/blobs/authorize\-data\-operations\-cli#set\-environment\-variables\-for\-authorization\-parameters
.IP \[bu] 2
https://docs.microsoft.com/en\-us/python/api/azure\-storage\-blob/?view=azure\-python
.PP
For Google Cloud Storage: * Credentials:
https://cloud.google.com/docs/authentication/getting\-started#setting_the_environment_variable
.PP
Only authentication with \f[C]GOOGLE_APPLICATION_CREDENTIALS\f[] env is
supported at the moment.
.SH DEPENDENCIES
.PP
If using \f[C]\-\-cloud\-provider=aws\-s3\f[]:
.IP \[bu] 2
boto3
.PP
If using \f[C]\-\-cloud\-provider=azure\-blob\-storage\f[]:
.IP \[bu] 2
azure\-storage\-blob
.IP \[bu] 2
azure\-identity (optional, if you wish to use DefaultAzureCredential)
.PP
If using \f[C]\-\-cloud\-provider=google\-cloud\-storage\f[] *
google\-cloud\-storage
.SH EXIT STATUS
.TP
.B 0
Success
.RS
.RE
.TP
.B 1
The keep command was not successful
.RS
.RE
.TP
.B 2
The connection to the cloud provider failed
.RS
.RE
.TP
.B 3
There was an error in the command input
.RS
.RE
.TP
.B Other non\-zero codes
Failure
.RS
.RE
.SH BUGS
.PP
Barman has been extensively tested, and is currently being used in
several production environments.
However, we cannot exclude the presence of bugs.
.PP
Any bug can be reported via the GitHub issue tracker.
.SH RESOURCES
.IP \[bu] 2
Homepage: <https://www.pgbarman.org/>
.IP \[bu] 2
Documentation: <https://docs.pgbarman.org/>
.IP \[bu] 2
Professional support: <https://www.enterprisedb.com/>
.SH COPYING
.PP
Barman is the property of EnterpriseDB UK Limited and its code is
distributed under GNU General Public License v3.
.PP
Â© Copyright EnterpriseDB UK Limited 2011\-2022
.SH AUTHORS
EnterpriseDB <https://www.enterprisedb.com>.
